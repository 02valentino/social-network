{% extends 'base.html' %}

{% block content %}
  <h2>{{ profile_user.username }}</h2>

  {% if profile_user.bio %}
    <p><strong>Bio:</strong> {{ profile_user.bio }}</p>
  {% endif %}

  {% if user.is_authenticated and user == profile_user %}
    <p><strong>Email:</strong> {{ profile_user.email }}</p>
    <p><strong>Joined:</strong> {{ profile_user.date_joined }}</p>
    <p><a href="{% url 'edit-profile' %}">Edit Profile</a></p>
  {% endif %}

{% if user.is_authenticated and user != profile_user %}
  <form method="post" action="{% url 'send-friend-request' profile_user.username %}">
    {% csrf_token %}
    {% if is_friend %}
      <p>You and {{ profile_user.username }} are friends.</p>
    {% elif request_sent %}
      <button formaction="{% url 'cancel-friend-request' profile_user.username %}" type="submit">Cancel Request</button>
    {% elif request_received %}
      <button formaction="{% url 'accept-friend-request' profile_user.username %}" type="submit">Accept</button>
      <button formaction="{% url 'decline-friend-request' profile_user.username %}" type="submit">Decline</button>
    {% else %}
      <button type="submit">Send Friend Request</button>
    {% endif %}
  </form>
{% endif %}

  {% if user.is_authenticated %}
    <h3>Posts by {{ profile_user.username }}</h3>
    {% if posts %}
      <ul>
        {% for post in posts %}
          <li>{{ post.content }} <em>â€” {{ post.posted_at|date:"M d, Y H:i" }}</em></li>
          {% include "network/partials/like_button.html" with post=post %}
        {% endfor %}
      </ul>
    {% else %}
      <p>No posts yet.</p>
    {% endif %}
  {% else %}
    <p><em>You must be logged in to view this user's posts.</em></p>
  {% endif %}
{% endblock %}
